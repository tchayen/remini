var e,t,n,o,r=Object.defineProperty,s=Object.defineProperties,i=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=(e,t,n)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,c=(e,t)=>{for(var n in t||(t={}))p.call(t,n)&&l(e,n,t[n]);if(d)for(var n of d(t))a.call(t,n)&&l(e,n,t[n]);return e},f=(e,t)=>s(e,i(t));(t=e||(e={}))[t.COMPONENT=1]="COMPONENT",t[t.HOST=2]="HOST",t[t.TEXT=3]="TEXT",t[t.PROVIDER=4]="PROVIDER",t[t.NULL=5]="NULL",t[t.FRAGMENT=6]="FRAGMENT",(o=n||(n={}))[o.STATE=1]="STATE",o[o.EFFECT=2]="EFFECT",o[o.REF=3]="REF",o[o.CONTEXT=4]="CONTEXT",o[o.MEMO=5]="MEMO";const E=e=>!!e.match(new RegExp("on[A-Z].*")),h=e=>e.replace("on","").toLowerCase(),u=e=>"viewBox"===e?e:T(e),T=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),O=e=>Object.keys(e).map((t=>{const n=e[t];return`${T(t)}:${n}`})).join(";"),k=t=>{let n=t;for(;n.kind!==e.COMPONENT&&n.parent;)n=n.parent;return n.kind!==e.COMPONENT?null:n},N=t=>{let n=t;for(;n.kind!==e.HOST&&n.parent;)n=n.parent;if(n.kind!==e.HOST)throw new Error("Couldn't find node.");return n},v=t=>{var n;t.kind===e.HOST||t.kind===e.TEXT?null==(n=t.native.parentNode)||n.removeChild(t.native):t.descendants.forEach((e=>{v(e)}))},C={findClosestComponent:k,findClosestHostNode:N,createHostNode:e=>{const t="svg"===(n=e.tag)||"circle"===n||"path"===n?document.createElementNS("http://www.w3.org/2000/svg",n):document.createElement(n);var n;return Object.entries(e.props).forEach((([e,n])=>{if("children"===e||"ref"===e);else if("style"===e){const o="string"==typeof n?n:O(n);t.setAttribute(e,o)}else E(e)?t.addEventListener(h(e),n):t.setAttribute(u(e),n)})),t},updateHostNode:(e,t)=>{const n=e.native;Object.keys(e.props).forEach((o=>{if("children"===o||"ref"===o);else if(E(o))n.removeEventListener(h(o),e.props[o]);else if(t.props[o]||n.removeAttribute(o),t.props[o])if("style"===o){const e="string"==typeof t.props[o]?t.props[o]:O(t.props[o]);n.setAttribute(o,e)}else n.setAttribute(u(o),t.props[o])})),Object.keys(t.props).forEach((o=>{if("children"===o||"ref"===o);else if(E(o))n.addEventListener(h(o),t.props[o]);else if(!e.props[o])if("style"===o){const e="string"==typeof t.props[o]?t.props[o]:O(t.props[o]);n.setAttribute(o,e)}else n.setAttribute(u(o),t.props[o])}))},removeHostNode:v,appendChild:(e,t)=>{e.appendChild(t)},createTextNode:e=>document.createTextNode(e),updateTextNode:(e,t)=>{e.native.nodeValue=t}},w=t=>{if(t.kind===e.HOST||t.kind===e.TEXT){const{children:e}=t.native.parent;e.splice(e.indexOf(t.native),1)}else t.descendants.forEach((e=>{w(e)}))},g={findClosestComponent:k,createHostNode:e=>{const t={tag:e.tag,children:[],attributes:{}};return Object.entries(e.props).forEach((([e,n])=>{if("children"===e||"ref"===e);else if("style"===e){const o="string"==typeof n?n:O(n);t.attributes[e]=o}else E(e)||(t.attributes[u(e)]=n)})),t},findClosestHostNode:N,removeHostNode:w,updateHostNode:(e,t)=>{const n=e.native;Object.keys(e.props).forEach((e=>{if("children"===e||"ref"===e);else if(E(e));else if(t.props[e]||delete n.attributes[e],t.props[e])if("style"===e){const o="string"==typeof t.props[e]?t.props[e]:O(t.props[e]);n.attributes[e]=o}else n.attributes[u(e)]=t.props[e]})),Object.keys(t.props).forEach((o=>{if("children"===o||"ref"===o);else if(E(o));else if(!e.props[o])if("style"===o){const t="string"==typeof e.props[o]?e.props[o]:O(e.props[o]);n.attributes[o]=t}else n.attributes[u(o)]=t.props[o]}))},appendChild:(e,t)=>{e.children.push(t)},createTextNode:e=>e,updateTextNode:(e,t)=>{e.native=t}};let m=null,y=null,M=0,H=null;const b=new Map,x=new Map;let S=!1;const P=[],R=[];function F(t,n,...o){const r=f(c({},n||{}),{children:o.flat().map((t=>"string"==typeof t?{kind:e.TEXT,content:t}:"number"==typeof t?{kind:e.TEXT,content:t.toString()}:t)).filter(Boolean)});if("function"==typeof t)return t.context?{kind:e.PROVIDER,props:f(c({},r),{$$context:t.context})}:{kind:e.COMPONENT,render:t,props:r};if("string"==typeof t)return""===t?{kind:e.FRAGMENT,props:r}:{kind:e.HOST,tag:t,props:r};throw new Error("Something went wrong.")}const A=(t,o,r)=>{const{host:s,isHydrating:i}=r;H=s;const d=y,p=M;let a=null;if(o&&o.kind===e.TEXT||t.kind===e.TEXT)return;let l=[];if(t.kind===e.COMPONENT)y=t,M=0,l=[t.render(t.props)].filter(Boolean),M=0;else if(o&&"props"in o&&(t.kind===e.HOST||t.kind===e.PROVIDER||t.kind===e.FRAGMENT)){if(t.kind===e.PROVIDER){const e=b.get(t.context);e&&(a={context:t.context,value:e}),b.set(t.context,{value:t.props.value})}l=o.props.children}i&&t.kind===e.HOST&&o&&o.kind===e.HOST&&s.updateHostNode(t,o);const E=Math.max(t.descendants.length,l.length),h=[];for(let e=0;e<E;e++)h.push([t.descendants[e],l[e]]);h.forEach((([o,d])=>{if(o&&d&&(o.kind===e.COMPONENT&&d.kind===e.COMPONENT&&o.render===d.render||o.kind===e.HOST&&d.kind===e.HOST&&o.tag===d.tag||o.kind===e.FRAGMENT&&d.kind===e.FRAGMENT||o.kind===e.PROVIDER&&d.kind===e.PROVIDER||o.kind===e.TEXT&&d.kind===e.TEXT))o.kind===e.HOST&&d.kind===e.HOST?s.updateHostNode(o,d):o.kind===e.TEXT&&d.kind===e.TEXT&&o.content!==d.content&&(o.content=d.content,s.updateTextNode(o,d.content)),"props"in o&&"props"in d&&(o.props=d.props),A(o,d,r);else if(o&&d){let i;if(d.kind===e.COMPONENT)i=f(c({},d),{parent:t,descendants:[],hooks:[]}),s.removeHostNode(o);else if(d.kind===e.HOST){const n=s.findClosestHostNode(t),r=f(c({},d),{parent:t,descendants:[]}),p=s.createHostNode(d);o.kind===e.HOST||o.kind===e.TEXT?n.native.replaceChild(p,o.native):(s.removeHostNode(o),s.appendChild(n.native,p)),r.native=p,i=r}else if(d.kind===e.TEXT){const n=s.findClosestHostNode(t),r=f(c({},d),{parent:t}),p=s.createTextNode(d.content);if(o.kind===e.TEXT)throw new Error("Update should have happened on this node.");o.kind===e.HOST?(n.native.replaceChild(p,o.native),r.native=p):(s.removeHostNode(o),s.appendChild(n.native,p),r.native=p),i=r}else if(d.kind===e.PROVIDER)i=f(c({},d),{context:d.props.$$context,parent:t,descendants:[]}),s.removeHostNode(o);else{if(d.kind!==e.FRAGMENT)throw new Error("Couldn't resolve node kind.");i=f(c({},d),{parent:t,descendants:[]}),s.removeHostNode(o)}o.kind===e.COMPONENT&&o.hooks.forEach((e=>{e.type===n.EFFECT&&e.cleanup&&e.cleanup()})),t.descendants[t.descendants.indexOf(o)]=i,A(i,d,r)}else if(o||void 0===d){if(void 0!==o&&!d){const r=t.descendants.indexOf(o);o.kind===e.COMPONENT?o.hooks.forEach((e=>{e.type===n.EFFECT&&e.cleanup&&e.cleanup()})):o.kind===e.PROVIDER&&b.delete(o.context),s.removeHostNode(o),t.descendants.splice(r,1)}}else{let o;if(d.kind===e.COMPONENT)o=f(c({},d),{parent:t,descendants:[],hooks:[]}),d.kind,e.COMPONENT;else if(d.kind===e.HOST){const r=f(c({},d),{parent:t,descendants:[]}),p=s.findClosestHostNode(t);i?(r.native=z,q()):(r.native=s.createHostNode(d),s.appendChild(p.native,r.native)),o=r;const a=s.findClosestComponent(t);if(a&&a.kind===e.COMPONENT)for(const e of a.hooks)e.type===n.REF&&d.props.ref===e&&(e.current=o.native)}else if(d.kind===e.TEXT){const e=f(c({},d),{parent:t}),n=s.findClosestHostNode(t);if(i)e.native=z,q();else{const t=s.createTextNode(d.content);s.appendChild(n.native,t),e.native=t}o=e}else if(d.kind===e.PROVIDER)o=f(c({},d),{parent:t,descendants:[],context:d.props.$$context});else{if(d.kind!==e.FRAGMENT)throw new Error("Couldn't resolve node kind.");o=f(c({},d),{parent:t,descendants:[]})}t.descendants.push(o),A(o,d,r)}})),t.kind===e.PROVIDER&&null!==a&&b.set(a.context,{value:a.value}),y=d,M=p,H=null},X=(e,t,n)=>{if(P.push({node:e,element:t}),S)return;let o;for(S=!0;o=P.shift();){let e;for(A(o.node,o.element,n);e=R.shift();)e()}b.clear(),S=!1},j=(t,o)=>{const r=y,s=M;if(!r||r.kind!==e.COMPONENT)throw new Error("Executing useEffect for non-function element.");R.push((()=>{if(!r||r.kind!==e.COMPONENT)throw new Error("Executing useEffect for non-function element.");if(void 0===r.hooks[s]){const e={type:n.EFFECT,cleanup:void 0,dependencies:o};r.hooks[s]=e;const i=t();e.cleanup=i||void 0}else if(o){const e=r.hooks[s];if(e.type!==n.EFFECT||void 0===e.dependencies)throw new Error("Something went wrong.");let i=!1;for(let t=0;t<o.length;t++)o[t]!==e.dependencies[t]&&(i=!0);if(i){const e=t();r.hooks[s]={type:n.EFFECT,cleanup:e||void 0,dependencies:o}}}else if(!o){const e=t();r.hooks[s]={type:n.EFFECT,cleanup:e||void 0,dependencies:o}}})),M+=1},$=t=>{const o=y,r=M,s=H;if(!o||o.kind!==e.COMPONENT)throw new Error("Executing useState for non-function element.");if(!s)throw new Error("Missing host context.");void 0===o.hooks[r]&&(o.hooks[r]={type:n.STATE,state:t});const i=o.hooks[r];if(i.type!==n.STATE)throw new Error("Something went wrong.");return M+=1,[i.state,t=>{if(!o||o.kind!==e.COMPONENT)throw new Error("Executing useState for non-function element.");i.state=t instanceof Function?t(i.state):t,X(o,null,{host:s})}]},D=()=>{if(!y||y.kind!==e.COMPONENT)throw new Error("Can't use useRef on this node.");let t=y.hooks[M];if(void 0===t&&(t={type:n.REF,current:null},y.hooks[M]=t),t.type!==n.REF)throw new Error("Something went wrong.");return M+=1,t},I=(t,o)=>{if(!y||y.kind!==e.COMPONENT)throw new Error("Can't call useMemo on this node.");if(void 0===y.hooks[M])y.hooks[M]={type:n.MEMO,memo:t(),dependencies:o};else{const e=y.hooks[M];if(e.type!==n.MEMO||!e.dependencies)throw new Error("Something went wrong.");let r=!1;for(let t=0;t<o.length;t++)o[t]!==e.dependencies[t]&&(r=!0);if(r){const e=t();y.hooks[M]={type:n.MEMO,memo:e,dependencies:o}}}const r=y.hooks[M];if(r.type!==n.MEMO)throw new Error("Something went wrong.");return M+=1,r.memo},V=()=>{const e={},t=({value:e})=>F("a",{});return t.context=e,e.Provider=t,e},L=t=>{if(!y||y.kind!==e.COMPONENT)throw new Error("Can't call useContext on this node.");const o=b.get(t);(void 0===y.hooks[M]||o)&&(y.hooks[M]={type:n.CONTEXT,context:o.value});const r=y.hooks[M];if(r.type!==n.CONTEXT)throw new Error("Something went wrong.");return M+=1,r.context},G=(t,n)=>{m={kind:e.HOST,props:{children:[t]},tag:n.tagName.toLowerCase(),native:n,parent:null,descendants:[]},x.clear(),X(m,F("div",{},t),{host:C})},B=e=>{if("string"==typeof e)return e;const t=Object.keys(e.attributes).length>0?" ":"",n=Object.keys(e.attributes).map((t=>`${t}="${e.attributes[t]}"`)).join(" "),o=e.children.map((e=>B(e))).join("");return`<${e.tag}${t}${n}>${o}</${e.tag}>`},U=t=>(m={kind:e.HOST,props:{children:[t],id:"root"},tag:"div",native:{tag:"div",attributes:{id:"root"},children:[]},parent:null,descendants:[]},X(m,F("div",{},t),{host:g}),B(m.native)),Z=(t,n)=>{m={kind:e.HOST,props:{children:[t]},tag:n.tagName.toLowerCase(),native:n,parent:null,descendants:[]},z=n.firstChild,X(m,F("div",{},t),{host:C,isHydrating:!0}),z=null};let z=null;const q=()=>{if(null!==z)if(z.firstChild)z=z.firstChild;else if(z.nextSibling)z=z.nextSibling;else{for(;!z.nextSibling;)if(z=z.parentNode,null===z)return;z=z.nextSibling}};export{m as _rootNode,V as createContext,F as createElement,Z as hydrate,G as render,U as renderToString,L as useContext,j as useEffect,I as useMemo,D as useRef,$ as useState};
